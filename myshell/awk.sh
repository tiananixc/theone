#!/bin/bash
dates=$(date -d last-day +%m%d);filename='access'$dates'.log';mv $filename bd;cd bd;|awk -F'"' '$4~/Baiduspider/' $filename>bd$dates.log;echo 'Logfile Split Success!';awk -f ../spider.awk $filename;echo '\n-----------------------------\n';hws=`awk '$8~/listprovideinfox/' bd$dates.log|wc -l`;echo 'listprovideinfox:'$hws;tagnum=`awk '$8~/ShowBizInfo/' bd$dates.log|wc -l`;echo 'ShowBizInfo:'$tagnum;comlistnum=`awk '$8~/providetype/' bd$dates.log|wc -l`;echo 'providetype:'$comlistnum;pronum=`awk '$8~/showprovideinfo/' bd$dates.log|wc -l`;echo 'showprovideinfo:'$pronum;newsnum=`awk '$8~/showagentinfo/' bd$dates.log|wc -l`;echo 'showagentinfo:'$newsnum;ListBuyInfo=`awk '$8~/ListBuyInfo/' bd$dates.log|wc -l`;echo 'ListBuyInfo:'$ListBuyInfo;	showbuyinfo=`awk '$8~/showbuyinfo/' bd$dates.log|wc -l`;echo 'showbuyinfo:'$showbuyinfo;listproduct=`awk '$8~/listproduct/' bd$dates.log|wc -l`;echo 'listproduct:'$listproduct;showproduce=`awk '$8~/showproduce/' bd$dates.log|wc -l`;echo 'showproduce:'$showproduce;listcompany=`awk '$8~/listcompany/' bd$dates.log|wc -l`;echo 'listcompany:'$listcompany;echo '----------------------------\n';sitecode='http://www.baidu.com/s?wd=site:spzs.com';www=`curl -i $sitecode>sitehahait.txt`;sitev=`cat sitehahait.txt|grep -o -E '<b style="color:#333">.+</b>'|sed 's/<b.*">//g'|sed 's/<\/b>//g'`;echo '收录为：'$sitev;suoyin=`cat sitehahait.txt|grep -o -E 'c-icon-setting.+</div></div></div><script' | head -1|grep -o -P '\d+'`;echo '索引为：'$suoyin;echo '\n-----------------------------\n';rm sitehahait.txt;chinazurl='http://seo.chinaz.com/?host=spzs.com';chinaz=`curl $chinazurl>chinaz.txt`;kwnum=`cat chinaz.txt|grep '<div class="Ma01LiRow w10-7">'|grep -o -P '">\d+<'|head -1|grep -o -P '\d+'`;echo '预估流量为：'$kwnum;ipnum=`cat chinaz.txt|grep -n '<div class="Ma01LiRow w10-7">'|grep -o -P '">\d+<'|tail -1|grep -o -P '\d+'`;echo '关键词数为：'$ipnum;rm chinaz.txt;echo '------------------------';Baidus=`grep Baiduspider $filename|wc -l`;echo 'Baiduspider:'$Baidus;_360Spider=`grep 360Spider $filename|wc -l`;echo '360Spider:'$_360Spider;google=`grep google $filename|wc -l`;echo 'google:'$google;sogou=`grep sogou $filename|wc -l`;echo 'sogou:'$sogou;Yisou=`grep YisouSpider $filename|wc -l`;echo 'YisouSpider:'$Yisou;