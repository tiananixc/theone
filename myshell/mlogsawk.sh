#!/bin/bash
dates=$1; cd bd;echo $dates' moblewap log analytics rasurlt：';filename='access'$dates'.log';mlogname='mlog'$dates'.log';bdname='mbd'$dates'.log';awk '($9~/http:\/\/m\.spzs\.com/)' $filename|sed 's/:90//g'>$mlogname;grep -a Baiduspider $mlogname>$bdname;echo 'Logfile Split Success!';echo '--------------抓取量最大的前30个页面---------------';awk '{print $9}' $bdname|sort|uniq -c|sort -nr|head -30;echo '123654';echo '--------------抓取响应数据最大的前30个页面---------------';awk '{print $9,$7}' $bdname|sort -nrk2|head -30;echo '--------------抓取量最大的前30个目录---------------';awk '{print $9}' $bdname|awk -F'/' '{print $4}'|sort|uniq -c|sort -nr|head -30;echo '--------------抓取量最大的404页面前30个页面---------------';awk '$6~/404/'  $bdname|awk '{print $9}'|sort|uniq -c|sort -nr|head -30;echo '--------------以下为各蜘蛛抓取情况 反馈码汇总---------------';Baidus=`grep Baiduspider $mlogname|wc -l`;echo 'Baiduspider:'$Baidus;_360Spider=`grep 360Spider $mlogname|wc -l`;echo '360Spider:'$_360Spider;google=`grep google $mlogname|wc -l`;echo 'google:'$google;sogou=`grep sogou $mlogname|wc -l`;echo 'sogou:'$sogou;Yisou=`grep YisouSpider $mlogname|wc -l`;echo 'YisouSpider:'$Yisou;echo '--------------日志分析完成！------------';rm $mlogname;rm $bdname;