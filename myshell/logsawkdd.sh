#!/bin/bash
dates=$1; filename=$2'.log';echo $dates''$filename' log analytics rasurlt：';newfilename=$filename;bdname='bd'$filename$dates'.log';cd bd;grep -a Baiduspider $newfilename|sed 's/:90//g'>$bdname;echo 'Logfile is Split Successlly!';echo '--------------抓取量最大的前30个页面---------------';awk '{print $9}' $bdname|sort|uniq -c|sort -nr|head -30;echo '--------------抓取量最大的前30个二级域名---------------';awk '{print $9}' $bdname|awk -F'/' '{print $3}'|sort|uniq -c|sort -nr|head -30;echo '--------------抓取响应数据最大的前30个页面---------------';awk '{print $9,$7}' $bdname|sort -nrk2|head -30;echo '--------------抓取量最大的前30个目录---------------';awk '{print $9}' $bdname|awk -F'/' '{print $4}'|sort|uniq -c|sort -nr|head -30;echo '--------------抓取量最大的404页面前30个页面---------------';awk '$6~/404/'  $bdname|awk '{print $9}'|sort|uniq -c|sort -nr|head -30;echo '--------------以下为各蜘蛛抓取情况---------------';Baidus=`grep -a Baiduspider $newfilename|wc -l`;echo 'Baiduspider:'$Baidus;_360Spider=`grep -a 360Spider $newfilename|wc -l`;echo '360Spider:'$_360Spider;google=`grep -a google $newfilename|wc -l`;echo 'google:'$google;sogou=`grep -a sogou $newfilename|wc -l`;echo 'sogou:'$sogou;Yisou=`grep -a YisouSpider $newfilename|wc -l`;echo 'YisouSpider:'$Yisou;applenum=`grep -a Macintosh $newfilename|wc -l`;echo 'AppleBot:'$applenum;echo '--------------日志分析完成！------------';rm $bdname;